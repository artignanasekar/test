<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>World of Bits ‚Äì Arti</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <style>
      html,
      body,
      #app {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
      }

      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      }

      #app {
        display: flex;
        flex-direction: column;
      }

      #map {
        flex: 1 1 auto;
      }

      #hud {
        flex: 0 0 auto;
        padding: 0.5rem 1rem;
        border-top: 1px solid #ddd;
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
        background: #fafafa;
        font-size: 0.9rem;
      }

      #hud-main {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
      }

      #hud-instructions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem 1rem;
        font-size: 0.75rem;
        color: #555;
      }

      #hud button {
        padding: 0.3rem 0.7rem;
        border-radius: 4px;
        border: 1px solid #ccc;
        background: white;
        cursor: pointer;
      }

      #reset {
        margin-left: auto;
      }

      .label {
        font-weight: 600;
      }

      .token-label {
        background: rgba(0, 0, 0, 0.75);
        color: #fff;
        border-radius: 4px;
        padding: 0 4px;
        font-size: 0.75rem;
      }

      .player-icon {
        position: relative;
        width: 48px;
        height: 48px;
        transform: translate(-50%, -50%);
        pointer-events: none;
      }

      .player-marker {
        --heading: 0deg;
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .player-heading {
        position: absolute;
        width: 36px;
        height: 36px;
        top: 6px;
        left: 6px;
        transform-origin: 50% 80%;
        transform: rotate(var(--heading));
        background: radial-gradient(
          ellipse at 50% 90%,
          rgba(65, 139, 255, 0.35),
          rgba(65, 139, 255, 0.05)
        );
        clip-path: polygon(50% 0%, 78% 82%, 22% 82%);
        opacity: 0;
        transition: opacity 0.2s ease-out;
        filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.15));
      }

      .player-icon.has-heading .player-heading {
        opacity: 1;
      }

      .player-emoji {
        font-size: 24px;
        line-height: 24px;
        text-align: center;
      }

      /* Movement button cluster */
      #move-controls {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.15rem;
        font-size: 0.8rem;
      }

      #move-controls-row {
        display: flex;
        gap: 0.15rem;
      }

      #move-controls button {
        width: 2rem;
        height: 2rem;
        padding: 0;
      }

      .movement-select {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.8rem;
      }

      .movement-select select {
        padding: 0.15rem 0.35rem;
        font-size: 0.8rem;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div id="map"></div>
      <div id="hud">
        <div id="hud-main">
          <span class="label">Score:</span>
          <span id="score">0</span>

          <span class="label">Held:</span>
          <span id="held">‚Äî</span>

          <div id="move-controls">
            <button id="btn-up">‚Üë</button>
            <div id="move-controls-row">
              <button id="btn-left">‚Üê</button>
              <button id="btn-down">‚Üì</button>
              <button id="btn-right">‚Üí</button>
            </div>
          </div>

          <div class="movement-select">
            <span class="label">Movement:</span>
            <select id="movement-mode">
              <option value="buttons">Buttons / Keyboard</option>
              <option value="geo">Geolocation</option>
            </select>
          </div>

          <button id="reset">Reset world</button>
        </div>

        <div id="hud-instructions">
          <span class="label">How to play:</span>
          <span>üê± = you. Use the arrow buttons or WASD/arrow keys in ‚ÄúButtons‚Äù
            mode.</span>
          <span>Switch to ‚ÄúGeolocation‚Äù to move the cat by moving with your
            device (you‚Äôll be asked for location permission).</span>
          <span>The blue fan points the way you‚Äôre facing when your device gives
            heading info.</span>
          <span>Click nearby cells to pick up / drop tokens.</span>
          <span>üüß <strong>C</strong> = craft table. Drop tokens here to combine
            them.</span>
          <span>üü© <strong>‚òÖ</strong> = bank. Click while holding a token to add
            its value to your Score.</span>
        </div>
      </div>
    </div>

    <!-- Leaflet JS (global L) -->
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>

    <!-- Your game entry point -->
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
